<?xml version="1.0" encoding="UTF-8"?>
<server description="Users CRUD Liberty Server">

    <!-- Enable Liberty features for Jakarta EE 10 -->
    <featureManager>
        <feature>jakartaee-10.0</feature>
        <feature>microProfile-6.0</feature>
    </featureManager>

    <!-- HTTP Endpoint -->
    <httpEndpoint id="defaultHttpEndpoint"
                  httpPort="9080"
                  httpsPort="9443" />

    <!-- PostgreSQL JDBC Driver Library -->
    <library id="postgresql-library">
        <fileset dir="${shared.resource.dir}/postgresql" includes="*.jar"/>
    </library>

    <!-- PostgreSQL Data Source -->
    <dataSource id="usersDataSource" jndiName="jdbc/usersDB">
        <jdbcDriver libraryRef="postgresql-library"/>
        <properties.postgresql 
            serverName="${env.DB_HOST}"
            portNumber="${env.DB_PORT}"
            databaseName="${env.DB_NAME}"
            user="${env.DB_USER}"
            password="${env.DB_PASSWORD}"
            currentSchema="public"/>
        <connectionManager maxPoolSize="20" minPoolSize="5"/>
    </dataSource>

    <!-- Application Configuration -->
    <webApplication id="users-crud" 
                    location="users-crud.war" 
                    contextRoot="/">
        <classloader delegation="parentLast"/>
    </webApplication>

    <!-- Logging -->
    <logging consoleLogLevel="INFO" 
             traceSpecification="*=info:com.users.crud.*=all"/>

    <!-- Application Security (disabled for development) -->
    <applicationMonitor updateTrigger="polled" pollingRate="5s"/>
    
</server>
